// ==UserScript==
// @name         FZManager-Min
// @namespace    https://vex.systems/
// @version      1.0.0
// @match        https://factorio.zone/*
// @grant        unsafeWindow
// ==/UserScript==

!function(){let e=null,t=null;unsafeWindow.console.stdlog=unsafeWindow.console.log.bind(unsafeWindow.console),unsafeWindow.console.log=(...t)=>{for(const n of t)n?.visitSecret&&(e=n.visitSecret,localStorage.setItem("vs0",n.visitSecret));unsafeWindow.console.stdlog(...t)},setTimeout((()=>{t=localStorage.userToken||null}),2e3);let n=!1,o=!0;const l=document.createElement("input"),s='<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>';let a=JSON.parse(localStorage.getItem("fz_session_tokens")||"[]");function r(){localStorage.setItem("fz_session_tokens",JSON.stringify(a))}const d=["/help [command]","/clear","/alerts [enable | disable | mute | unmute] [alert type]","/color [color name | rgba]","/evolution","/seed","/time","/version","/players","/players online","/players count","/ignore [player name]","/ignores","/whisper [player name] [message]","/shout [message]","/mute [player name]","/unmute [player name]","/whitelist add <player name>","/whitelist remove <player name>","/whitelist get","/whitelist clear","/ban [player name] [reason]","/unban [player name]","/banlist add [player name]","/banlist remove [player name]","/banlist get","/banlist clear","/kick [player name] [reason]","/admins","/promote [player name]","/demote [player name]","/permissions","/config get [option]","/config set [option] [value]","/delete-blueprint-library [player name | everybody confirm]","/swap-players [player name] [player name]","/server-save","/save","/editor","/c <lua code>","/command <lua code>","/measured-command <lua code>","/mc <lua code>","/silent-command <lua code>","/sc <lua code>"],i={en:{settings:"FZManager Settings",theme:"Theme",white:"White (Default)",dark:"Dark",amoled:"AMOLED",borderRadius:"Custom border radius",commandHints:"Enable command hints",secrets:"Secrets",visitSecret:"Visit Secret",sessionSecret:"Session Secret",notAvailable:"Not available",uploadMods:"Upload Mods",selectMods:"Select Mod Files",size:"Size",uploadSelected:"Upload Selected Mods",uploading:"Uploading...",uploaded:"Uploaded ✓",failed:"Failed ✗",noModsSelected:"No mods selected",pleaseSelect:"Please select mods first",close:"Close",language:"Language",english:"English",polish:"Polish",russian:"Russian",german:"German",manageTokens:"Manage Session Tokens",tokenName:"Token Name",addToken:"Add Token",addCustomToken:"Add Custom Token",switchTo:"Switch to",delete:"Delete",currentToken:"Current Token",newToken:"New Token",addNewToken:"Add New Token",tokenAdded:"Token added",tokenSwitched:"Token switched",tokenDeleted:"Token deleted",customToken:"Custom Token",enterTokenValue:"Enter token value",resetSession:"Reset Session Secret",confirmReset:"Reset current session secret?",reset:"Reset",cancel:"Cancel",sessionReset:"Session secret reset",github:"GitHub Repository",noTokens:"No tokens saved",token:"Token"},pl:{settings:"Ustawienia FZManager",theme:"Motyw",white:"Biały (Domyślny)",dark:"Ciemny",amoled:"AMOLED",borderRadius:"Niestandardowe zaokrąglenie krawędzi",commandHints:"Włącz podpowiedzi komend",secrets:"Sekrety",visitSecret:"Sekret Wizyty",sessionSecret:"Sekret Sesji",notAvailable:"Niedostępne",uploadMods:"Załaduj Mody",selectMods:"Wybierz Pliki Modów",size:"Rozmiar",uploadSelected:"Załaduj Wybrane Mody",uploading:"Wczytywanie...",uploaded:"Wczytano ✓",failed:"Błąd ✗",noModsSelected:"Nie wybrano modów",pleaseSelect:"Najpierw wybierz mody",close:"Zamknij",language:"Język",english:"Angielski",polish:"Polski",russian:"Rosyjski",german:"Niemiecki",manageTokens:"Zarządzaj Tokenami Sesji",tokenName:"Nazwa Tokenu",addToken:"Dodaj Token",addCustomToken:"Dodaj Własny Token",switchTo:"Przełącz na",delete:"Usuń",currentToken:"Aktualny Token",newToken:"Nowy Token",addNewToken:"Dodaj Nowy Token",tokenAdded:"Token dodany",tokenSwitched:"Token przełączony",tokenDeleted:"Token usunięty",customToken:"Własny Token",enterTokenValue:"Wprowadź wartość tokenu",resetSession:"Zresetuj Sekret Sesji",confirmReset:"Zresetować aktualny sekret sesji?",reset:"Resetuj",cancel:"Anuluj",sessionReset:"Sekret sesji zresetowany",github:"Repozytorium GitHub",noTokens:"Brak zapisanych tokenów",token:"Token"},ru:{settings:"Настройки FZManager",theme:"Тема",white:"Белая (По умолчанию)",dark:"Тёмная",amoled:"AMOLED",borderRadius:"Скругление границ",commandHints:"Включить подсказки команд",secrets:"Секреты",visitSecret:"Секрет посещения",sessionSecret:"Секрет сессии",notAvailable:"Недоступно",uploadMods:"Загрузить Моды",selectMods:"Выбрать Файлы Модов",size:"Размер",uploadSelected:"Загрузить Выбранные Моды",uploading:"Загрузка...",uploaded:"Загружено ✓",failed:"Ошибка ✗",noModsSelected:"Моды не выбраны",pleaseSelect:"Сначала выберите моды",close:"Закрыть",language:"Язык",english:"Английский",polish:"Польский",russian:"Русский",german:"Немецкий",manageTokens:"Управление Токенами Сессии",tokenName:"Имя Токена",addToken:"Добавить Токен",addCustomToken:"Добавить Свой Токен",switchTo:"Переключить на",delete:"Удалить",currentToken:"Текущий Токен",newToken:"Новый Токен",addNewToken:"Добавить Новый Токен",tokenAdded:"Токен добавлен",tokenSwitched:"Токен переключен",tokenDeleted:"Токен удалён",customToken:"Свой Токен",enterTokenValue:"Введите значение токена",resetSession:"Сбросить Секрет Сессии",confirmReset:"Сбросить текущий секрет сессии?",reset:"Сбросить",cancel:"Отмена",sessionReset:"Секрет сессии сброшен",github:"Репозиторий GitHub",noTokens:"Нет сохранённых токенов",token:"Токен"},de:{settings:"FZManager Einstellungen",theme:"Thema",white:"Weiß (Standard)",dark:"Dunkel",amoled:"AMOLED",borderRadius:"Benutzerdefinierte Randabrundung",commandHints:"Befehls-Hinweise aktivieren",secrets:"Geheimnisse",visitSecret:"Besuchsgeheimnis",sessionSecret:"Sitzungsgeheimnis",notAvailable:"Nicht verfügbar",uploadMods:"Mods Hochladen",selectMods:"Mod-Dateien Auswählen",size:"Größe",uploadSelected:"Ausgewählte Mods Hochladen",uploading:"Wird hochgeladen...",uploaded:"Hochgeladen ✓",failed:"Fehlgeschlagen ✗",noModsSelected:"Keine Mods ausgewählt",pleaseSelect:"Bitte zuerst Mods auswählen",close:"Schließen",language:"Sprache",english:"Englisch",polish:"Polnisch",russian:"Russisch",german:"Deutsch",manageTokens:"Sitzungs-Token Verwalten",tokenName:"Token-Name",addToken:"Token Hinzufügen",addCustomToken:"Eigenes Token Hinzufügen",switchTo:"Wechseln zu",delete:"Löschen",currentToken:"Aktueller Token",newToken:"Neuer Token",addNewToken:"Neuen Token Hinzufügen",tokenAdded:"Token hinzugefügt",tokenSwitched:"Token gewechselt",tokenDeleted:"Token gelöscht",customToken:"Eigenes Token",enterTokenValue:"Token-Wert eingeben",resetSession:"Sitzungsgeheimnis Zurücksetzen",confirmReset:"Aktuelles Sitzungsgeheimnis zurücksetzen?",reset:"Zurücksetzen",cancel:"Abbrechen",sessionReset:"Sitzungsgeheimnis zurückgesetzt",github:"GitHub Repository",noTokens:"Keine Token gespeichert",token:"Token"}};let c=localStorage.getItem("fz_language")||"en";const p=e=>i[c][e]||i.en[e];function y(e){const t=document.querySelectorAll("button"),n=document.querySelectorAll("input, select, .socket-info, .input-area");t.forEach((t=>t.style.borderRadius=e+"px")),n.forEach((t=>t.style.borderRadius=e+"px"))}function u(){document.querySelectorAll(".input-area").forEach((e=>{e.placeholder="Enter a command to execute",e.style.padding="6px 10px",e.style.borderRadius=n?parseInt(l.value)+"px":"6px",e.style.border="1px solid var(--background-div-border)",e.style.background="var(--background-div-color)",e.style.color="inherit",e.style.transition="all 0.2s ease",e.addEventListener("focus",(()=>{e.style.borderColor="#666",e.style.boxShadow="0 0 5px rgba(100, 100, 100, 0.3)"})),e.addEventListener("blur",(()=>{e.style.borderColor="var(--background-div-border)",e.style.boxShadow="none"}))}))}function m(e,t,n=!1,o){const l=document.createElement("div");l.style.display="flex",l.style.alignItems="center",l.style.gap="8px",l.style.cursor="pointer",l.style.userSelect="none";const a=document.createElement("input");a.type="checkbox",a.id=e,a.checked=n,a.style.display="none";const r=document.createElement("div");r.style.width="18px",r.style.height="18px",r.style.borderRadius="4px",r.style.border="2px solid #666",r.style.position="relative",r.style.transition="all 0.2s ease",r.style.display="flex",r.style.alignItems="center",r.style.justifyContent="center";const d=document.createElement("div");d.innerHTML=s,d.style.opacity=n?"1":"0",d.style.transform=n?"scale(1)":"scale(0)",d.style.transition="all 0.2s ease",d.style.color="white",r.appendChild(d);const i=document.createElement("label");return i.htmlFor=e,i.textContent=t,i.style.fontSize="13px",i.style.opacity="0.9",i.style.cursor="pointer",r.addEventListener("click",(()=>{a.checked=!a.checked,r.style.background=a.checked?"#666":"transparent",r.style.borderColor=(a.checked,"#666"),d.style.opacity=a.checked?"1":"0",d.style.transform=a.checked?"scale(1)":"scale(0)",o&&o(a.checked)})),r.style.background=n?"#666":"transparent",r.style.borderColor="#666",l.appendChild(a),l.appendChild(r),l.appendChild(i),a.addEventListener("change",(()=>{r.style.background=a.checked?"#666":"transparent",r.style.borderColor=(a.checked,"#666"),d.style.opacity=a.checked?"1":"0",d.style.transform=a.checked?"scale(1)":"scale(0)",o&&o(a.checked)})),{container:l,checkbox:a}}function g(e,t,n,o){const l=document.createElement("div");l.style.position="relative",l.style.width="100%";const s=document.createElement("select");s.id=e,s.style.width="100%",s.style.padding="6px 30px 6px 8px",s.style.borderRadius="6px",s.style.border="1px solid #666",s.style.background="rgba(100, 100, 100, 0.1)",s.style.color="inherit",s.style.fontSize="13px",s.style.appearance="none",s.style.cursor="pointer",s.style.transition="all 0.2s ease",s.style.outline="none",t.forEach((e=>{const t=document.createElement("option");t.value=e.value,t.textContent=e.label,s.appendChild(t)})),s.value=n;const a=document.createElement("div");return a.innerHTML="▼",a.style.position="absolute",a.style.right="8px",a.style.top="50%",a.style.transform="translateY(-50%)",a.style.pointerEvents="none",a.style.color="#666",a.style.fontSize="10px",s.addEventListener("change",(()=>{o&&o(s.value)})),s.addEventListener("focus",(()=>{s.style.borderColor="#888",s.style.boxShadow="0 0 0 2px rgba(100, 100, 100, 0.1)"})),s.addEventListener("blur",(()=>{s.style.borderColor="#666",s.style.boxShadow="none"})),l.appendChild(s),l.appendChild(a),{container:l,select:s}}function b(e,t="info"){const n=document.createElement("div");n.textContent=e,n.style.position="fixed",n.style.top="20px",n.style.right="20px",n.style.background="success"===t?"rgba(40, 167, 69, 0.9)":"error"===t?"rgba(220, 53, 69, 0.9)":"rgba(100, 100, 100, 0.9)",n.style.color="white",n.style.padding="10px 16px",n.style.borderRadius="6px",n.style.zIndex="1000000",n.style.fontSize="13px",n.style.boxShadow="0 4px 12px rgba(0,0,0,0.3)",n.style.opacity="0",n.style.transform="translateX(20px)",n.style.transition="all 0.3s ease",document.body.appendChild(n),setTimeout((()=>{n.style.opacity="1",n.style.transform="translateX(0)"}),10),setTimeout((()=>{n.style.opacity="0",n.style.transform="translateX(20px)",setTimeout((()=>n.remove()),300)}),3e3)}function x(){location.reload()}function h(){const e=document.createElement("div");e.style.position="fixed",e.style.inset="0",e.style.background="rgba(0,0,0,0.5)",e.style.backdropFilter="blur(4px)",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.zIndex="1000001",e.style.opacity="0",e.style.transition="opacity 0.3s ease";const n=document.createElement("div");n.style.background="white"===localStorage.getItem("fz_theme")?"#fff":"#333",n.style.color="white"===localStorage.getItem("fz_theme")?"#000":"#fff",n.style.padding="20px",n.style.borderRadius="10px",n.style.minWidth="300px",n.style.boxShadow="0 10px 30px rgba(0,0,0,0.3)",n.style.transform="scale(0.9)",n.style.transition="transform 0.3s ease";const o=document.createElement("div");o.textContent=p("resetSession"),o.style.fontSize="16px",o.style.fontWeight="600",o.style.marginBottom="15px";const l=document.createElement("div");l.textContent=p("confirmReset"),l.style.fontSize="14px",l.style.opacity="0.8",l.style.marginBottom="20px";const s=document.createElement("div");s.style.display="flex",s.style.justifyContent="flex-end",s.style.gap="10px";const a=document.createElement("button");a.textContent=p("cancel"),a.style.padding="8px 16px",a.style.borderRadius="6px",a.style.border="1px solid #666",a.style.background="transparent",a.style.color="inherit",a.style.cursor="pointer",a.style.transition="all 0.2s ease";const r=document.createElement("button");return r.textContent=p("reset"),r.style.padding="8px 16px",r.style.borderRadius="6px",r.style.border="1px solid #dc3545",r.style.background="rgba(220, 53, 69, 0.1)",r.style.color="#dc3545",r.style.cursor="pointer",r.style.transition="all 0.2s ease",a.addEventListener("mouseenter",(()=>{a.style.background="rgba(100, 100, 100, 0.1)"})),a.addEventListener("mouseleave",(()=>{a.style.background="transparent"})),r.addEventListener("mouseenter",(()=>{r.style.background="rgba(220, 53, 69, 0.2)"})),r.addEventListener("mouseleave",(()=>{r.style.background="rgba(220, 53, 69, 0.1)"})),a.addEventListener("click",(()=>{e.style.opacity="0",n.style.transform="scale(0.9)",setTimeout((()=>e.remove()),300)})),r.addEventListener("click",(()=>{delete localStorage.userToken,t=null,b(p("sessionReset"),"success"),setTimeout((()=>location.reload()),500)})),s.appendChild(a),s.appendChild(r),n.appendChild(o),n.appendChild(l),n.appendChild(s),e.appendChild(n),document.body.appendChild(e),setTimeout((()=>{e.style.opacity="1",n.style.transform="scale(1)"}),10),e}function f(){const s=document.querySelector(".fre-info.fre-bottom");if(!s)return;s.appendChild(document.createElement("br"));const d=document.createElement("button");d.textContent=p("settings"),d.style.padding="6px 12px",d.style.borderRadius="6px",d.style.border="1px solid #666",d.style.background="rgba(100, 100, 100, 0.1)",d.style.color="inherit",d.style.cursor="pointer",d.style.marginTop="8px",d.style.fontSize="13px",d.setAttribute("data-translate","settings"),s.appendChild(d);const f=document.createElement("div");f.id="fzmanager-modal",f.style.position="fixed",f.style.inset="0",f.style.background="rgba(0,0,0,0.55)",f.style.backdropFilter="blur(4px)",f.style.display="none",f.style.alignItems="center",f.style.justifyContent="center",f.style.zIndex="999999",f.style.opacity="0",f.style.transition="opacity 0.25s ease";const k=document.createElement("div");k.id="fzmanager-modal-box",k.style.borderRadius="10px",k.style.padding="18px",k.style.minWidth="480px",k.style.width="max-content",k.style.maxWidth="90vw",k.style.display="flex",k.style.flexDirection="column",k.style.gap="14px",k.style.transform="scale(0.95)",k.style.transition="transform 0.25s ease";const v=document.createElement("div");v.textContent=p("settings"),v.style.fontSize="18px",v.style.fontWeight="700",v.style.marginBottom="4px",v.style.textAlign="center",v.setAttribute("data-translate","settings");const C=document.createElement("div");C.style.display="grid",C.style.gridTemplateColumns="1fr 1fr",C.style.gap="20px",C.style.marginTop="6px";const S=document.createElement("div");S.style.display="flex",S.style.flexDirection="column",S.style.gap="14px";const E=document.createElement("div");E.textContent=p("secrets"),E.style.fontSize="15px",E.style.fontWeight="600",E.style.textAlign="left",E.style.borderBottom="1px solid #666",E.style.paddingBottom="6px",E.setAttribute("data-translate","secrets");const T=document.createElement("div");function w(e,t,n=!1){const o=document.createElement("div");o.style.display="flex",o.style.flexDirection="column",o.style.gap="4px";const l=document.createElement("div");l.style.display="flex",l.style.justifyContent="space-between",l.style.alignItems="center";const s=document.createElement("div");if(s.textContent=p(e),s.style.fontSize="13px",s.style.opacity="0.9",s.setAttribute("data-translate",e),l.appendChild(s),n&&"sessionSecret"===e){const e=document.createElement("button");e.textContent=p("resetSession"),e.style.padding="4px 8px",e.style.borderRadius="4px",e.style.border="1px solid #dc3545",e.style.background="rgba(220, 53, 69, 0.1)",e.style.color="#dc3545",e.style.cursor="pointer",e.style.fontSize="11px",e.style.transition="all 0.2s ease",e.setAttribute("data-translate","resetSession"),e.addEventListener("mouseenter",(()=>{e.style.background="rgba(220, 53, 69, 0.2)"})),e.addEventListener("mouseleave",(()=>{e.style.background="rgba(220, 53, 69, 0.1)"})),e.addEventListener("click",h),l.appendChild(e)}const a=document.createElement("div");return a.style.padding="6px 8px",a.style.borderRadius="6px",a.style.border="1px solid #666",a.style.background="rgba(100, 100, 100, 0.1)",a.style.filter="blur(6px)",a.style.transition="all 0.2s ease",a.style.cursor="pointer",a.style.whiteSpace="nowrap",a.style.overflow="hidden",a.style.textOverflow="ellipsis",a.style.fontFamily="monospace",a.style.fontSize="12px",a.style.minHeight="32px",a.style.display="flex",a.style.alignItems="center",a.addEventListener("mouseenter",(()=>{a.style.filter="blur(0px)",a.style.background="rgba(100, 100, 100, 0.15)",a.style.borderColor="#888"})),a.addEventListener("mouseleave",(()=>{a.style.filter="blur(6px)",a.style.background="rgba(100, 100, 100, 0.1)",a.style.borderColor="#666"})),setInterval((()=>a.textContent=t()||p("notAvailable")),500),o.appendChild(l),o.appendChild(a),o}T.style.display="flex",T.style.flexDirection="column",T.style.gap="10px",T.appendChild(w("visitSecret",(()=>e))),T.appendChild(w("sessionSecret",(()=>t),!0));const z=document.createElement("div");z.textContent=p("manageTokens"),z.style.fontSize="15px",z.style.fontWeight="600",z.style.textAlign="left",z.style.borderBottom="1px solid #666",z.style.paddingBottom="6px",z.style.marginTop="8px",z.setAttribute("data-translate","manageTokens");const A=document.createElement("div");A.id="token-list",A.style.maxHeight="150px",A.style.overflowY="auto",A.style.border="1px solid #666",A.style.borderRadius="6px",A.style.padding="8px",A.style.display="flex",A.style.flexDirection="column",A.style.gap="6px";const R=document.createElement("div");R.style.display="flex",R.style.flexDirection="column",R.style.gap="6px",R.style.marginTop="8px";const L=document.createElement("div");L.style.display="flex",L.style.gap="4px",L.style.marginBottom="6px";const M=document.createElement("button");M.textContent=p("currentToken"),M.style.padding="6px 10px",M.style.borderRadius="4px",M.style.border="1px solid #666",M.style.background="rgba(100, 100, 100, 0.15)",M.style.color="inherit",M.style.cursor="pointer",M.style.fontSize="12px",M.style.flex="1",M.setAttribute("data-translate","currentToken");const D=document.createElement("button");D.textContent=p("customToken"),D.style.padding="6px 10px",D.style.borderRadius="4px",D.style.border="1px solid #666",D.style.background="rgba(100, 100, 100, 0.1)",D.style.color="inherit",D.style.cursor="pointer",D.style.fontSize="12px",D.style.flex="1",D.setAttribute("data-translate","customToken"),L.appendChild(M),L.appendChild(D);const N=document.createElement("div");N.style.display="flex",N.style.gap="6px";const W=document.createElement("input");W.type="text",W.placeholder=p("tokenName"),W.style.flex="1",W.style.padding="6px 8px",W.style.borderRadius="6px",W.style.border="1px solid #666",W.style.background="rgba(100, 100, 100, 0.1)",W.style.color="inherit",W.style.fontSize="12px",W.style.outline="none",W.setAttribute("data-translate-placeholder","tokenName");const I=document.createElement("button");I.textContent=p("addToken"),I.style.padding="6px 12px",I.style.borderRadius="6px",I.style.border="1px solid #666",I.style.background="rgba(100, 100, 100, 0.1)",I.style.color="inherit",I.style.cursor="pointer",I.style.fontSize="12px",I.style.transition="all 0.2s ease",I.setAttribute("data-translate","addToken");const j=document.createElement("div");j.style.display="none",j.style.flexDirection="column",j.style.gap="6px";const q=document.createElement("input");q.type="text",q.placeholder=p("tokenName"),q.style.padding="6px 8px",q.style.borderRadius="6px",q.style.border="1px solid #666",q.style.background="rgba(100, 100, 100, 0.1)",q.style.color="inherit",q.style.fontSize="12px",q.style.outline="none",q.setAttribute("data-translate-placeholder","tokenName");const B=document.createElement("input");B.type="text",B.placeholder=p("enterTokenValue"),B.style.padding="6px 8px",B.style.borderRadius="6px",B.style.border="1px solid #666",B.style.background="rgba(100, 100, 100, 0.1)",B.style.color="inherit",B.style.fontSize="12px",B.style.outline="none",B.setAttribute("data-translate-placeholder","enterTokenValue");const H=document.createElement("button");H.textContent=p("addCustomToken"),H.style.padding="6px 12px",H.style.borderRadius="6px",H.style.border="1px solid #666",H.style.background="rgba(100, 100, 100, 0.1)",H.style.color="inherit",H.style.cursor="pointer",H.style.fontSize="12px",H.style.transition="all 0.2s ease",H.setAttribute("data-translate","addCustomToken");let F="current";M.addEventListener("click",(()=>{F="current",M.style.background="rgba(100, 100, 100, 0.15)",D.style.background="rgba(100, 100, 100, 0.1)",N.style.display="flex",j.style.display="none"})),D.addEventListener("click",(()=>{F="custom",M.style.background="rgba(100, 100, 100, 0.1)",D.style.background="rgba(100, 100, 100, 0.15)",N.style.display="none",j.style.display="flex"})),I.addEventListener("mouseenter",(()=>{I.style.background="rgba(100, 100, 100, 0.2)",I.style.borderColor="#888"})),I.addEventListener("mouseleave",(()=>{I.style.background="rgba(100, 100, 100, 0.1)",I.style.borderColor="#666"})),H.addEventListener("mouseenter",(()=>{H.style.background="rgba(100, 100, 100, 0.2)",H.style.borderColor="#888"})),H.addEventListener("mouseleave",(()=>{H.style.background="rgba(100, 100, 100, 0.1)",H.style.borderColor="#666"})),N.appendChild(W),N.appendChild(I),j.appendChild(q),j.appendChild(B),j.appendChild(H),R.appendChild(L),R.appendChild(N),R.appendChild(j),S.appendChild(E),S.appendChild(T),S.appendChild(z),S.appendChild(A),S.appendChild(R);const _=document.createElement("div");_.style.display="flex",_.style.flexDirection="column",_.style.gap="16px";const Z=document.createElement("div");Z.style.display="flex",Z.style.flexDirection="column",Z.style.gap="12px";const O=document.createElement("div");O.textContent="Settings",O.style.fontSize="15px",O.style.fontWeight="600",O.style.textAlign="left",O.style.borderBottom="1px solid #666",O.style.paddingBottom="6px";const $=document.createElement("div");$.style.display="flex",$.style.flexDirection="column",$.style.gap="4px";const P=document.createElement("div");P.textContent=p("language"),P.style.fontSize="13px",P.style.opacity="0.9",P.setAttribute("data-translate","language");const V=g("language-select",[{value:"en",label:p("english")},{value:"pl",label:p("polish")},{value:"ru",label:p("russian")},{value:"de",label:p("german")}],c,(e=>{c=e,localStorage.setItem("fz_language",e),setTimeout(x,300)}));$.appendChild(P),$.appendChild(V.container);const G=document.createElement("div");G.style.display="flex",G.style.flexDirection="column",G.style.gap="4px";const U=document.createElement("div");U.textContent=p("theme"),U.style.fontSize="13px",U.style.opacity="0.9",U.setAttribute("data-translate","theme");const J=g("theme-select",[{value:"white",label:p("white")},{value:"dark",label:p("dark")},{value:"amoled",label:p("amoled")}],localStorage.getItem("fz_theme")||"dark",(e=>{localStorage.setItem("fz_theme",e),location.reload()}));G.appendChild(U),G.appendChild(J.container);const X=document.createElement("div");X.style.display="flex",X.style.flexDirection="column",X.style.gap="8px";const Y=m("border-checkbox",p("borderRadius"),n,(e=>{n=e,l.slider.disabled=!n,l.slider.style.opacity=n?"1":"0.5",n?(y(parseInt(l.slider.value)),u()):(y(6),u())})),K=function(e,t,n,o,l){const s=document.createElement("div");s.style.display="flex",s.style.flexDirection="column",s.style.gap="6px",s.style.width="100%";const a=document.createElement("input");a.type="range",a.id=e,a.min=t,a.max=n,a.value=o,a.style.width="100%",a.style.height="5px",a.style.appearance="none",a.style.background="rgba(100, 100, 100, 0.2)",a.style.borderRadius="10px",a.style.outline="none",a.style.opacity="1",a.style.transition="all 0.2s ease";const r=(o-t)/(n-t)*100;a.style.background=`linear-gradient(to right, #666 0%, #666 ${r}%, rgba(100, 100, 100, 0.2) ${r}%, rgba(100, 100, 100, 0.2) 100%)`,a.addEventListener("input",(()=>{const e=(a.value-t)/(n-t)*100;a.style.background=`linear-gradient(to right, #666 0%, #666 ${e}%, rgba(100, 100, 100, 0.2) ${e}%, rgba(100, 100, 100, 0.2) 100%)`,l&&l(a.value)}));const d=document.createElement("style");return d.textContent=`\n        #${e}::-webkit-slider-thumb {\n            appearance: none;\n            width: 16px;\n            height: 16px;\n            border-radius: 50%;\n            background: #666;\n            border: 2px solid rgba(255,255,255,0.8);\n            cursor: pointer;\n            box-shadow: 0 0 4px rgba(0,0,0,0.3);\n            transition: all 0.2s ease;\n        }\n\n        #${e}::-webkit-slider-thumb:hover {\n            transform: scale(1.1);\n            box-shadow: 0 0 6px rgba(0,0,0,0.4);\n        }\n\n        #${e}::-moz-range-thumb {\n            width: 16px;\n            height: 16px;\n            border-radius: 50%;\n            background: #666;\n            border: 2px solid rgba(255,255,255,0.8);\n            cursor: pointer;\n            box-shadow: 0 0 4px rgba(0,0,0,0.3);\n            transition: all 0.2s ease;\n        }\n\n        #${e}::-moz-range-thumb:hover {\n            transform: scale(1.1);\n            box-shadow: 0 0 6px rgba(0,0,0,0.4);\n        }\n    `,document.head.appendChild(d),s.appendChild(a),{container:s,slider:a}}("border-slider",0,50,6,(e=>{n&&(y(parseInt(e)),u())}));X.appendChild(Y.container),X.appendChild(K.container);const Q=m("hint-checkbox",p("commandHints"),o,(e=>{o=e})),ee=document.createElement("div");ee.style.display="flex",ee.style.flexDirection="column",ee.style.gap="10px",ee.style.marginTop="4px";const te=document.createElement("div");te.textContent=p("uploadMods"),te.style.fontSize="15px",te.style.fontWeight="600",te.style.textAlign="left",te.style.borderBottom="1px solid #666",te.style.paddingBottom="6px",te.setAttribute("data-translate","uploadMods");const ne=document.createElement("input");ne.type="file",ne.multiple=!0,ne.accept=".zip",ne.style.padding="6px 8px",ne.style.borderRadius="6px",ne.style.border="1px solid #666",ne.style.background="rgba(100, 100, 100, 0.1)",ne.style.color="inherit",ne.style.cursor="pointer",ne.style.fontSize="12px",ne.style.transition="all 0.2s ease",ne.addEventListener("focus",(()=>{ne.style.borderColor="#888",ne.style.boxShadow="0 0 0 2px rgba(100, 100, 100, 0.1)"})),ne.addEventListener("blur",(()=>{ne.style.borderColor="#666",ne.style.boxShadow="none"}));const oe=document.createElement("div");oe.id="mod-upload-list",oe.style.maxHeight="120px",oe.style.overflowY="auto",oe.style.border="1px solid #666",oe.style.borderRadius="6px",oe.style.padding="6px",oe.style.display="flex",oe.style.flexDirection="column",oe.style.gap="4px";const le=document.createElement("button");le.textContent=p("uploadSelected"),le.style.padding="6px 12px",le.style.borderRadius="6px",le.style.border="1px solid #666",le.style.background="rgba(100, 100, 100, 0.1)",le.style.color="inherit",le.style.fontWeight="500",le.style.cursor="pointer",le.style.transition="all 0.2s ease",le.style.marginTop="4px",le.style.fontSize="13px",le.setAttribute("data-translate","uploadSelected"),le.addEventListener("mouseenter",(()=>{le.style.background="rgba(100, 100, 100, 0.2)",le.style.borderColor="#888"})),le.addEventListener("mouseleave",(()=>{le.style.background="rgba(100, 100, 100, 0.1)",le.style.borderColor="#666"})),Z.appendChild($),Z.appendChild(G),Z.appendChild(X),Z.appendChild(Q.container),ee.appendChild(te),ee.appendChild(ne),ee.appendChild(oe),ee.appendChild(le),_.appendChild(Z),_.appendChild(ee),C.appendChild(S),C.appendChild(_);const se=document.createElement("div");se.style.display="flex",se.style.justifyContent="space-between",se.style.alignItems="center",se.style.marginTop="12px",se.style.borderTop="1px solid #666",se.style.paddingTop="10px";const ae=document.createElement("p");ae.target="_blank",ae.innerHTML="github.com/l1806-vex/FZManager",ae.style.display="inline-block",ae.style.marginRight="10px",ae.style.textDecoration="none";const re=document.createElement("button");function de(){if(A.innerHTML="",0===a.length){const e=document.createElement("div");return e.textContent=p("noTokens"),e.style.opacity="0.6",e.style.textAlign="center",e.style.padding="8px",void A.appendChild(e)}a.forEach(((e,n)=>{const o=document.createElement("div");o.style.display="flex",o.style.justifyContent="space-between",o.style.alignItems="center",o.style.padding="6px 8px",o.style.borderRadius="4px",o.style.border="1px solid #666",o.style.background="rgba(100, 100, 100, 0.05)",o.style.marginBottom="4px";const l=document.createElement("div");l.style.display="flex",l.style.flexDirection="column",l.style.gap="2px";const s=document.createElement("div");s.textContent=e.name||`${p("token")} ${n+1}`,s.style.fontSize="12px",s.style.fontWeight="500";const d=document.createElement("div");d.textContent=e.value.substring(0,12)+"...",d.style.fontSize="10px",d.style.opacity="0.7",d.style.fontFamily="monospace",l.appendChild(s),l.appendChild(d);const i=document.createElement("div");i.style.display="flex",i.style.gap="4px";const c=document.createElement("button");c.textContent=p("switchTo"),c.style.padding="3px 6px",c.style.borderRadius="4px",c.style.border="1px solid #666",c.style.background="rgba(100, 100, 100, 0.1)",c.style.color="inherit",c.style.cursor="pointer",c.style.fontSize="10px",c.setAttribute("data-translate","switchTo");const y=document.createElement("button");y.textContent=p("delete"),y.style.padding="3px 6px",y.style.borderRadius="4px",y.style.border="1px solid #666",y.style.background="rgba(200, 50, 50, 0.1)",y.style.color="inherit",y.style.cursor="pointer",y.style.fontSize="10px",y.setAttribute("data-translate","delete"),c.addEventListener("click",(()=>{localStorage.userToken=e.value,t=e.value,b(p("tokenSwitched"),"success"),setTimeout((()=>location.reload()),500)})),y.addEventListener("click",(()=>{a.splice(n,1),r(),de(),b(p("tokenDeleted"),"info")})),i.appendChild(c),i.appendChild(y),o.appendChild(l),o.appendChild(i),A.appendChild(o)}))}re.textContent=p("close"),re.style.padding="6px 16px",re.style.borderRadius="6px",re.style.border="1px solid #666",re.style.background="rgba(100, 100, 100, 0.1)",re.style.color="inherit",re.style.cursor="pointer",re.style.transition="all 0.2s ease",re.style.fontWeight="500",re.style.fontSize="13px",re.setAttribute("data-translate","close"),re.addEventListener("mouseenter",(()=>{re.style.background="rgba(100, 100, 100, 0.2)",re.style.borderColor="#888"})),re.addEventListener("mouseleave",(()=>{re.style.background="rgba(100, 100, 100, 0.1)",re.style.borderColor="#666"})),se.appendChild(ae),se.appendChild(re),k.appendChild(v),k.appendChild(C),k.appendChild(se),f.appendChild(k),document.body.appendChild(f),I.addEventListener("click",(()=>{const e=W.value.trim(),t=localStorage.userToken;if(!t)return void b("No current token available","error");if(!e)return void b("Please enter a token name","error");const n=a.some((e=>e.value===t));n?b("Token already saved","error"):(a.push({name:e,value:t,date:(new Date).toISOString(),type:"current"}),r(),de(),W.value="",b(p("tokenAdded"),"success"))})),H.addEventListener("click",(()=>{const e=q.value.trim(),t=B.value.trim();if(!e)return void b("Please enter a token name","error");if(!t)return void b("Please enter a token value","error");const n=a.some((e=>e.value===t));n?b("Token already saved","error"):(a.push({name:e,value:t,date:(new Date).toISOString(),type:"custom"}),r(),de(),q.value="",B.value="",b(p("tokenAdded"),"success"))})),d.addEventListener("click",(()=>{f.style.display="flex",setTimeout((()=>{f.style.opacity="1",k.style.transform="scale(1)"}),20),de()})),re.addEventListener("click",(()=>{f.style.opacity="0",k.style.transform="scale(0.95)",setTimeout((()=>f.style.display="none"),250)})),f.addEventListener("click",(e=>{e.target===f&&(f.style.opacity="0",k.style.transform="scale(0.95)",setTimeout((()=>f.style.display="none"),250))})),ne.addEventListener("change",(()=>{if(oe.innerHTML="",0===ne.files.length){const e=document.createElement("div");return e.textContent=p("noModsSelected"),e.style.opacity="0.6",e.style.textAlign="center",e.style.padding="10px",void oe.appendChild(e)}for(let e=0;e<ne.files.length;e++){const t=ne.files[e],n=document.createElement("div");n.style.display="flex",n.style.flexDirection="column",n.style.gap="2px",n.style.padding="6px 8px",n.style.borderRadius="4px",n.style.border="1px solid #666",n.style.background="rgba(100, 100, 100, 0.05)";const o=document.createElement("div");o.textContent=t.name,o.style.fontSize="12px",o.style.fontFamily="monospace",o.style.overflow="hidden",o.style.textOverflow="ellipsis",o.style.whiteSpace="nowrap";const l=document.createElement("div");l.textContent=`${p("size")}: ${(t.size/1024/1024).toFixed(2)} MB`,l.style.fontSize="10px",l.style.opacity="0.7",n.appendChild(o),n.appendChild(l),oe.appendChild(n)}})),le.addEventListener("click",(()=>{if(0===ne.files.length){const e=document.createElement("div");return e.textContent=p("pleaseSelect"),e.style.color="#dc3545",e.style.padding="6px",e.style.textAlign="center",oe.appendChild(e),void setTimeout((()=>e.remove()),3e3)}for(let e=0;e<ne.files.length;e++){const t=ne.files[e],n=oe.children[e],o=document.createElement("div");o.textContent=p("uploading"),o.style.fontSize="10px",o.style.color="#ffc107",o.style.marginTop="2px",n.appendChild(o);const l=document.createElement("div");l.style.height="3px",l.style.background="rgba(100, 100, 100, 0.2)",l.style.borderRadius="2px",l.style.marginTop="4px",l.style.overflow="hidden";const s=document.createElement("div");s.style.height="100%",s.style.width="0%",s.style.background="linear-gradient(90deg, #666, #888)",s.style.transition="width 0.3s ease",s.style.borderRadius="2px",l.appendChild(s),n.appendChild(l);const a=new FormData;a.append("file",t),a.append("size",t.size),a.append("visitSecret",localStorage.getItem("vs0")),fetch("https://factorio.zone/api/mod/upload",{method:"POST",body:a}).then((e=>{if(!e.ok)throw new Error("Upload failed");s.style.width="100%",o.textContent=p("uploaded"),o.style.color="#28a745",n.style.borderColor="#28a745",n.style.background="rgba(40, 167, 69, 0.05)"})).catch((e=>{s.style.width="0%",o.textContent=p("failed"),o.style.color="#dc3545",n.style.borderColor="#dc3545",n.style.background="rgba(220, 53, 69, 0.05)"}))}le.disabled=!0,le.textContent=p("uploading"),le.style.opacity="0.6",setTimeout((()=>{le.disabled=!1,le.textContent=p("uploadSelected"),le.style.opacity="1"}),5e3)})),function(e){const t=document.querySelector(".control-container"),n=document.querySelector(".output-area"),o=document.querySelector(".socket-info"),l=document.querySelectorAll("button"),s=document.querySelectorAll("select"),a=document.querySelectorAll(".output-log"),r=document.querySelectorAll(".fre-arrow-up"),d=document.querySelectorAll(".input-area"),i=document.querySelector("#fzmanager-modal-box"),c=document.querySelector("#mod-upload-list");let p="#333",y="white",u="#444",m="#222",g="white",b="rgb(41,41,41)",x="white",h="#fff";"white"===e&&(p="#fff",y="#000",u="#f2f2f2",m="#f2f2f2",g="#000",b="#fff",x="#000",h="#f2f2f2"),"dark"===e&&(p="#333",y="#fff",u="#444",m="#222",g="#fff",b="rgb(41,41,41)",x="#fff",h="#111"),"amoled"===e&&(p="#000",y="#fff",u="#111",m="#000",g="#fff",b="#000",x="#fff",h="#111"),document.body.style.background=p,document.body.style.color=y,t&&(t.style.background=u),n&&(n.style.background=m),o&&(o.style.background=u,o.style.color=y,o.style.borderColor=y),l.forEach((e=>{e.style.color=y,e.style.background="transparent",e.style.borderColor=y})),s.forEach((e=>{e.style.color=y,e.style.background=u,e.style.borderColor=y})),a.forEach((e=>e.style.color=g)),d.forEach((e=>{e.style.background=u,e.style.color=y,e.style.borderColor=y})),r.forEach((t=>{t.style.filter="white"!==e?"invert(1)":""})),i&&(i.style.background=b,i.style.color=x),c&&(c.style.background=h)}(localStorage.getItem("fz_theme")||"dark"),setTimeout((()=>{document.querySelectorAll("[data-translate]").forEach((e=>{const t=e.getAttribute("data-translate");i[c][t]&&(e.textContent=i[c][t])})),document.querySelectorAll("[data-translate-placeholder]").forEach((e=>{const t=e.getAttribute("data-translate-placeholder");e.placeholder=p(t)}))}),100)}const k=setInterval((()=>{document.querySelector(".fre-info.fre-bottom")&&document.querySelector(".control-container")&&document.querySelector(".input-area")&&(clearInterval(k),f(),function(e=6){const t=document.querySelector("#start-button"),n=document.querySelector("#stop-button");t&&(t.style.border="2px solid #28a745",t.style.background="transparent",t.style.color="#28a745",t.style.borderRadius=e+"px",t.style.padding="6px 16px",t.style.fontWeight="600",t.style.transition="all 0.2s ease",t.addEventListener("mouseenter",(()=>{t.style.background="#28a745",t.style.color="#fff"})),t.addEventListener("mouseleave",(()=>{t.style.background="transparent",t.style.color="#28a745"}))),n&&(n.style.border="2px solid #dc3545",n.style.background="transparent",n.style.color="#dc3545",n.style.borderRadius=e+"px",n.style.padding="6px 16px",n.style.fontWeight="600",n.style.transition="all 0.2s ease",n.addEventListener("mouseenter",(()=>{n.style.background="#dc3545",n.style.color="#fff"})),n.addEventListener("mouseleave",(()=>{n.style.background="transparent",n.style.color="#dc3545"})))}(),function(){new MutationObserver((e=>{const t="white"===(localStorage.getItem("fz_theme")||"dark")?"#000":"#fff";e.forEach((e=>{e.addedNodes.forEach((e=>{1===e.nodeType&&e.classList.contains("output-log")&&(e.style.color=t),1===e.nodeType&&e.querySelectorAll(".output-log").forEach((e=>e.style.color=t))}))}))})).observe(document.body,{childList:!0,subtree:!0});const e=document.querySelectorAll(".output-log"),t="white"===(localStorage.getItem("fz_theme")||"dark")?"#000":"#fff";e.forEach((e=>e.style.color=t))}(),u(),function(){const e=document.querySelector(".input-area");if(!e)return;let t=document.createElement("div");e.parentNode.insertBefore(t,e),t.style.marginBottom="4px",t.style.background="rgba(0,0,0,0.85)",t.style.color="white",t.style.padding="6px 10px",t.style.borderRadius="6px",t.style.fontSize="14px",t.style.display="none",t.style.transition="all 0.2s ease",e.addEventListener("input",(()=>{if(!o||""===e.value.trim())return void(t.style.display="none");const n=d.find((t=>t.startsWith(e.value)));n?(t.textContent=n,t.style.display="block",t.style.opacity="0",setTimeout((()=>t.style.opacity="1"),10)):t.style.display="none"}))}())}),300)}();
